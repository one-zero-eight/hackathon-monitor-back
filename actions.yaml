actions:
    terminate_session:
        title: Terminate Session
        description: Terminate a PostgreSQL session by PID.
        arguments:
            pid:
                description: The PID of the session to terminate.
                type: int
        steps:
            - type: sql
              query: SELECT pg_terminate_backend(:pid)

    restart_db:
        title: Restart Database
        description: Activate checkpoint and then restart database.
        steps:
            - type: sql
              query: CHECKPOINT;
            - type: ssh
              query: echo {{ TARGET__SSH_PASSWORD }} | sudo -S systemctl restart postgresql

    create_dump:
        title: Create Dump
        description: Create dump of current database.
        arguments:
            dump_name:
                description: Name of the dump.
                type: string
        steps:
            - type: ssh
              query: pg_dump --dbname={{ TARGET__DB_URL }} | gzip > 'tmp/{{ dump_name }}.gz'
